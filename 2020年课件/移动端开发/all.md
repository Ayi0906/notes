[Toc]

## 移动端特点

- 小屏幕，触摸交互，屏幕尺寸繁多

## 屏幕大小

- 指屏幕的对角线长度，单位一般是英寸（inch）。常见的是3.5（iphone4）,4,4.7（iphone6），5.0,5.5,6.0（iphone6 plus）

- i inch = 2.54 cm

## 屏幕分辨率

- 屏幕横纵向上的像素点数，一般表示形式是`x*y`或者`y*x`表示，例如华为P30分辨率是`2340*1080`:水平方向2340的像素点，竖直方向上有1080个像素点
- 屏幕分辨率是固定值，出厂就有的，不可更改。

## 显示分辨率

- 计算机可以修改显示分辨率，由CPU与屏幕共同决定。
- 1080P的分辨率是1920X1080
- 720P是1280X720
- 2K屏幕是单一方向分辨率具有约2000像素的显示设备。最标准的2K分辨率是2048X1024

## 物理像素 / 设备像素

- 1个物理像素对应显示设备中一个微小的物理部件。(可以看做变色彩灯，由三个分别发红绿蓝色的二极管封装而成，通过控制每一支二极管的电流来混合出不同颜色的光)。
- 物理像素代表屏幕上有多少个像素点（彩灯），比如1920X1080上有2073600个像素点。这个是硬件设备，由制造商决定。
- 物理像素一般并不规则，不同颜色发光二极管的寿命并不同，蓝色二极管寿命最短。所以就有了钻石排列等排列方式。
- 不同厂家制作的屏幕设备是不同的，也没有硬性规定一个物理像素的长宽，像素点之间的间隔。因此如果按照物理像素来进行显示，可能在一个屏幕上测量长10cm的元素，在另一个屏幕上测量长度就变成了15cm。也因此需要设备独立像素来进行重新计算，保证每一个屏幕上的元素显示的大小是相同的。

## 设备独立像素（DIP，安卓中称为DP）

- 基于计算机控制的坐标系统和抽象像素（虚拟像素）
- 为了保证不同用户界面看到的元素一样大，需要保证 设备独立像素
- 设备独立像素由制造商决定。例如iphone6 的设备独立像素为 375 * 667
- 一个设备独立像素代表计算机可以控制的坐标系统中的一个点。
  - 例如iphone6的坐标轴是375X667，但其物理像素是750X1334。也就是说在iphone6里，一个设备独立像由四个物理像素来进行显示。
  - 例如iphone12ProMax物理像素1284X2778，设备独立像素428X926，也就是说在iphone12 Pro Max中一个设备独立像素由9个物理像素来进行显示
  - 普通屏幕下一个设备独立像素控制一个物理像素（封装二极管）
  - 高清屏幕下一个设备独立像素控制N个物理像素 

## Retina屏幕

- 高清屏幕的一种，苹果公司2010年推出，将更多的像素点（彩灯）压缩到一块屏幕里，从而达到更高的分辨率。
- 苹果曾经给出一个标准：手机屏幕达到300PPI，平板屏幕达到220PPI，笔记本电脑达到200PPI即可认为是Retina屏幕

## 像素密度PPI（pix per inch）

- 每英寸的物理像素点的数量。屏幕分辨率为1080X2340的iphone12mini为例，ppi=Math.sqrt(1080^2+2340^2)/5.4，值为476PPI
  - 通常可以这么说：同样的屏幕尺寸的情况下，ppi越高，屏幕显示效果越好。

## CSS像素

- CSS语言中用来表示长度的一个单位，单位是px
  - CSS像素不能直接和现实中的长度进行换算
  - 没有缩放的情况下，CSS像素与设备独立像素保持1:1的换算比。
    - 假如一个屏幕的设备独立像素为1920X1080，那么一个宽度为960px的元素视觉上会占据屏幕一半的宽度。
    - 通常情况下修改的分辨率是显示分辨率，（屏幕分辨率是像素点的排列不可更改），也因此将屏幕分辨率改小会让元素显得更大。

## 设备像素比（DPR）以及图片的高清显示

- 设备像素比指的是物理像素与设备独立像素的比例

  - 设备独立像素由1个或N个物理像素点（彩灯）来显示，物理像素点越多，显示的图像越清晰

  - 以iphone12 Pro Max为例：物理像素为1284 X 2778，逻辑像素为428 X 926，设备像素比为3。它代表一个设备独立像素使用9个物理像素来显示。

  - `window.devicePixelRatio`来获取屏幕设备像素比

  - ```
            @media only screen and (-webkit-min-device-pixel-ratio:1.25) {
                #d1 {
                    width: 160px;
                    height: 160px;
                    background-color: red;
                }
            }
    ```

  - 上面的代码用于应对不同的设备像素比下的图片的高清显示。比如一张图片存在100X100,200X200,300X300三种规格。使用上面的代码在不同的设备像素比下使用不同的1x，2x，3x图片。

## 位图像素

- 位图：称为点阵图像或者栅格图像，由单个的像素点组成。缩放后失真。一个位图像素对应一个物理像素，图片才能得到清晰的显示。
  - 就像沙滩上用彩色沙子绘制的图像，在五百米高空中可以看到精彩的画面，但当走进这片沙滩时，会看到组成图像的每一粒沙子以及每颗沙粒单纯且不可改变的颜色。
- 矢量图：称为向量图。矢量图是由多个对象的组合生成的。每一个对象的记录方式都是以数学函数来实现的。矢量图并不记录画面上的每一点信息，而是记录元素的形状以及颜色的算法。
  - 矢量图相对于位图，在颜色的复杂度上不如位图，更擅长于更改形状。矢量图需要相应的程序才能打开和编辑。

## 像素之间的关系

- 不缩放的情况下：css像素==设备独立像素==位图像素

## 真机测试流程

- 草料二维码网站可以将URI转换为二维码进行访问

## 视口

- PC端
  - css文档里，视口又被称为初始包含块。它由浏览器的可视区域组成。是所有css百分比宽度推算的根源。
  - `document.documentElement.clientWidth`:获取浏览器可视区域宽度
  - `window.innerWidth`:获取浏览器的窗口的宽度
    - 它和可是区域的区别在于如果浏览器右侧有滚动条，那么可视区域就需要减去滚动条的宽度。窗口宽度则不需要
  - `window.outerWidth`:获取浏览器总宽
    - 它与innerWidth的区别在于：当浏览器不是全屏的时候，浏览器外部有一圈阴影。outerWidth需要加上阴影的距离。
  - `screen.width`:获取屏幕的宽度（设备独立像素）
- 移动端
  - 移动端有3个视口：
    - 布局视口、视觉视口、理想视口
    - 获取布局视口：（它用来放置网页内容）
      - `document.documentElement.clientWidth/clientHeight`
      - `ctrl-shift-i`：打开后台
      - `ctrl-shift-m`：打开移动端视图
      - `dtrl-shift-d`：把控制台从下面移到右边
      - 视口大小由浏览器厂商决定，大多数设备的布局视口是980px
      - 一般网页大小960-1200px，而手机只有375。因此浏览器厂商用了一个虚拟视口980，将网页缩小显示在手机上。目的是兼容早期的PC页面。
    - 视觉视口：能看到的网页的区域
      - `window.innerWidth/innerHeight`
      - 移动浏览器没有控制台。
      - 页面不缩放的情况下，视觉视口宽度==布局视口宽度
    - 理想视口
      - 宽度与屏幕设备独立像素同宽的布局视口称为理想视口
      - 用户不需要缩放和滚动条就能看到网站的全部内容
      - 针对移动端的设计稿更容易开发（一般设计稿都是750px）
      - `<meta name="viewport" content="width=device-width,initial-scale=1.0">`
        - meta可以设置字符集，设置关键字，设置描述，设置作者

## 缩放

- 绝大多数网页不会允许用户把网页缩放的
- 980像素是浏览器厂商设置的布局视口的初始宽度
- 放大时：
  - 布局视口与视觉视口都在变小。元素本身不变（单个css像素占据的物理像素更多了）

## 点击穿透

- touch 事件结束后会默认触发元素的 click 事件，如没有设置完美视口，则事件触发的时间间隔为 300ms 左右，如设置完美视口则时间间隔为 10ms 左右。

- 如果 touch 事件隐藏了元素，则 click 动作将作用到新的元素上，触发新元素的 click 事件或页面跳转，此现象称为点击穿透

- 解决方法(禁止触发touchustart事件后再触发click事件)

  - 阻止默认事件

    - `e.preventDefault`

  - 阻止顶级元素事件的默认行为,可以增加一个包裹元素绑定,也可以给document和window对象绑定,不过需要关闭被动模式

    - ```
            document.addEventListener('touchstart', function (e) {
                  e.preventDefault()
              }, {
                  passive: false
              })
      ```

    - 暂不清楚原理

  - 